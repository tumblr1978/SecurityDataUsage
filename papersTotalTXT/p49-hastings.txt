Weak Keys Remain Widespread in Network Devices

Marcella Hastings

University of Pennsylvania
mhast@cis.upenn.edu

Joshua Fried

University of Pennsylvania

fjosh@cis.upenn.edu

Nadia Heninger

University of Pennsylvania
nadiah@cis.upenn.edu

ABSTRACT
In 2012, two academic groups reported having com-
puted the RSA private keys for 0.5% of HTTPS hosts on
the internet, and traced the underlying issue to widespread
random number generation failures on networked de-
vices. The vulnerability was reported to dozens of ven-
dors, several of whom responded with security advi-
sories, and the Linux kernel was patched to ﬁx a boot-
time entropy hole that contributed to the failures.

In this paper, we measure the actions taken by ven-
dors and end users over time in response to the origi-
nal disclosure. We analyzed public internet-wide TLS
scans performed between July 2010 and May 2016 and
extracted 81 million distinct RSA keys. We then com-
puted the pairwise common divisors for the entire set
in order to factor over 313,000 keys vulnerable to the
ﬂaw, and ﬁngerprinted implementations to study patch-
ing behavior over time across vendors. We ﬁnd that
many vendors appear to have never produced a patch,
and observed little to no patching behavior by end users
of aﬀected devices. The number of vulnerable hosts in-
creased in the years after notiﬁcation and public dis-
closure, and several newly vulnerable implementations
have appeared since 2012. Vendor notiﬁcation, positive
vendor responses, and even vendor-produced public se-
curity advisories appear to have little correlation with
end-user security.
Keywords
Security vulnerabilities; networked devices
1.

INTRODUCTION

In February of 2012, Lenstra, Hughes, Augier, Bos,
Kleinjung, and Wachter [26] and Heninger, Durumeric,
Permission to make digital or hard copies of all or part of this work for personal
or classroom use is granted without fee provided that copies are not made or
distributed for proﬁt or commercial advantage and that copies bear this notice
and the full citation on the ﬁrst page. Copyrights for components of this work
owned by others than the author(s) must be honored. Abstracting with credit is
permitted. To copy otherwise, or republish, to post on servers or to redistribute to
lists, requires prior speciﬁc permission and/or a fee. Request permissions from
permissions@acm.org.
IMC ’16, November 14–16, Santa Monica, CA, USA.
c(cid:13) 2016 Copyright held by the owner/author(s). Publication rights licensed to
ACM. ISBN 978-1-4503-4526-2/16/11. . . $15.00
DOI: http://dx.doi.org/10.1145/2987443.2987486

Wustrow, and Halderman [21] announced that they had
factored tens of thousands of public RSA keys from TLS
certiﬁcates. The latter group traced the vulnerability
to widespread failures in random number generators on
headless, embedded, and low-resource network devices.
While this vulnerability revealed the private keys for
0.5% of HTTPS hosts on the internet at the time, the
immediate security impact on those particular hosts
was likely limited by the fact that the vast majority of
compromised TLS certiﬁcates were not browser trusted,
and were automatically-generated certiﬁcates protect-
ing web login interfaces on consumer and small-business
grade routers and ﬁrewalls, remote server administra-
tion interfaces, and embedded device such as cooling
systems, building monitors, cameras, projectors, and
printers. Rather, the presence of weak keys was an ex-
ternally visible signal that the random number genera-
tion subsystems on entire classes of devices and across
multiple implementations had failed, likely impacting
these systems and many other hosts in a variety of ways.
In this paper, we study the disclosure process under-
taken by the authors of [21] and the aftermath of this
family of random number generation failures. We ag-
gregated publicly available internet-wide TLS scan data
dating back almost six years, including monthly scans
during the past four years from multiple sources. We
give more details on our data sources in Section 3.1. In
order to measure the incidence of vulnerable keys, we
extracted the 81 million distinct RSA moduli found in
these scans and ran a batch GCD algorithm to factor
improperly generated RSA keys. We were able to factor
over 313,000 moduli. (See Table 1.) To carry out such
a large computation eﬃciently for such a large number
of keys, we modiﬁed the algorithm to run in parallel
across a distributed cluster. We describe our computa-
tion in detail in Section 3.2. We then manually ﬁnger-
printed vulnerable implementations based on available
metadata, including certiﬁcate subjects, certiﬁcate sub-
ject alternative names, port scans, and known private
key behavior, as described in Section 3.3, and examine
vulnerability rates over time for user populations asso-
ciated with identiﬁed vendors in Section 4.

Previous studies of vulnerability patching have fo-
cused on patching behavior from system administra-

49tors in response to highly publicized vulnerabilities in
OpenSSL [40, 15] or in response to targeted vulnera-
bility notiﬁcations [27, 34]. In contrast, the vulnerabil-
ity disclosures undertaken by the authors of [21] were
targeted mainly at vendors of embedded and headless
devices, which are rarely updated by end users.

The widespread nature of the ﬂaw provides us with
an accidental historical experiment allowing us to study
the industry’s response to disclosure by comparing re-
sponses across many vendors. We describe in detail for
the ﬁrst time the results from the industry-wide dis-
closure process undertaken by the authors of [21]. In
particular, fewer than half of the organizations con-
tacted about the vulnerabilities responded at all to a
best-eﬀort attempt at vulnerability notiﬁcation.

We also give data on the post-notiﬁcation internet-
wide vulnerability rates for diﬀerent vendors in response
to the same vulnerability. Many vendors apparently
continued to ship vulnerable products for years after
receiving notiﬁcation of and even acknowledging the se-
curity vulnerability, and in some cases after putting out
security advisories for their products. Since the targets
of our study are primarily devices, rather than software
packages, end users must rely on vendors to distribute
updates in order to patch their own devices. We ob-
serve that for this vulnerability, end-user patching did
not appear to occur at all.

The single largest drop in the number of vulnera-
ble keys occurred shortly after the disclosure of the
Heartbleed vulnerability in April 2014. The decrease
in vulnerable keys is conﬁned to a handful of devices,
for which there was an even larger concurrent drop in
the total population of ﬁngerprinted devices, suggest-
ing that while in some cases the publicity may have
prompted device users to regenerate certiﬁcates or ap-
ply a patch that also ﬁxed the weak key vulnerability,
many device HTTPS interfaces may instead have simply
been taken oﬄine. In the case of at least one device fam-
ily, Heartbleed vulnerability scans were reported to ren-
der the device non-responsive. This suggests that end-
user device security can improve when vendors patch
vulnerabilities and end users are encouraged to apply
patches or change conﬁguration by widespread media
attention and targeted vulnerability notiﬁcations, but
that this process did not occur in response to the vul-
nerabilities we study in this paper.

2. BACKGROUND

2.1 TLS security

In this paper, we focus on RSA as used in the Trans-
port Layer Security (TLS) protocol, which is used for
HTTPS. Several studies have examined the HTTPS [16],
email [14], and other TLS application infrastructures [22].
In the TLS protocol, a server’s RSA public keys are in-
cluded in a server’s certiﬁcate, which is transmitted to
the client in response to a client hello message. When

HTTPS host records
Distinct HTTPS certiﬁcates
Distinct HTTPS moduli

Total distinct RSA moduli
Vulnerable RSA moduli

Vulnerable HTTPS host records
Vulnerable HTTPS certiﬁcates

1,526,222,329
65,285,795
50,677,278

81,228,736
313,330

2,964,447
1,441,437

Table 1: We analyzed six years of internet-wide HTTPS
scans in order to study server behavior over time. Each
host record represents a HTTPS handshake on a given
date with a server at some IP address. We augmented
our batch GCD computation with RSA public keys ex-
tracted from IMAPS, POP3S, SMTPS, and SSH scans,
but excluded these other protocols from further study.

client and server negotiate a cipher suite that includes
RSA key exchange, the client uses the server’s public
key to encrypt session key information; when they ne-
gotiate a Diﬃe-Hellman or elliptic-curve Diﬃe-Hellman
cipher suite, the server uses its RSA public key to sign
its key exchange message to prove authenticity. RSA
digital signatures are used to authenticate TLS certiﬁ-
cates; a certiﬁcate may be signed by a trusted certiﬁcate
authority’s public key or by a certiﬁcate chaining up to
a trusted root key, or self-signed by its own public key.
A compromised public key from a TLS certiﬁcate
could be used to passively decrypt TLS sessions that
had negotiated RSA key exchange. An active attacker
could use a compromised certiﬁcate key to impersonate
a trusted server whose certiﬁcate used that key, or to
perform a man-in-the-middle attack to decrypt or mod-
ify traﬃc using Diﬃe-Hellman or RSA cipher suites.
74% of the 61,240 vulnerable devices present in our most
recent scan data from April 2016 only support RSA key
exchange, making them vulnerable to passive decryp-
tion by an attacker who is able to observe network traf-
ﬁc. In order for an attacker to intercept network traﬃc,
they would need to be on the network path between the
victim client and the true server, or use a network at-
tack like DNS or BGP hijacking [8] to force the victim
to connect to the server via the client.

Among the vulnerable devices that we examined, HTTPS

is used primarily to serve remote management inter-
faces. Many of the vulnerable ﬁrewalls also use TLS
to encrypt SSL VPN connections. An attacker who is
able to decrypt connections to one of these devices may
obtain administrative credentials for the device or view
remote user traﬃc to internal network resources.
2.2 RSA and factoring

RSA [31] is the most commonly used public-key cryp-
tosystem on the internet. RSA keys can be used both
for encryption and digital signatures. An RSA pub-
lic key consists of a modulus N , which is the product
of two large primes p and q, and a public exponent e.

50Public Advisory

Private Response

Auto-Response

No Response

IBM
Innominate
Intel
Juniper
Tropos

Pogoplug
HP

Cisco
Sentry
Technicolor Hillstone Networks Haivision
AudioCodes Motorola
Ruckus
Linksys

Kronos

Brocade
NTI

McAfee
Emerson
ZyXEL
Dell
TP-Link Fortinet
Sinetica
2-Wire
D-Link
SkyStream Pronto
Xerox
Simton
Kyocera BelAir
AVM
JDSU
MRV

Table 2: 37 vendors were notiﬁed via email in February and March 2012 about weak TLS or SSH RSA key generation
in their products. Only ﬁve released a public security advisory. About half of the vendors acknowledged receipt.

The corresponding RSA private key is a private expo-

nent d = e−1 mod (p − 1)(q − 1), which is eﬃcient to

If
compute if the prime factorization of N is known.
the prime factorization of N is not known, the most
eﬃcient method known in general to compute an RSA
private key is to factor the modulus N into its prime
factors and use the factors to calculate d.

The most eﬃcient general-purpose factoring algorithm
is the number ﬁeld sieve, which has asymptotic com-
plexity exp((1.923 + o(1))(log N )1/3(log log N )2/3) [25].
Factoring a 512-bit RSA key using the number ﬁeld
sieve is within the range of attackers of even modest
resources today [38]; the current public factorization
record is a 768-bit RSA modulus factored by an aca-
demic team over several years, announced in 2009 [24],
and 1024-bit factorization is believed to be within the
range of governments.
2.3 Factoring weak RSA keys

Implementation ﬂaws can allow an attacker to break
RSA much more eﬃciently. The family of implementa-
tion ﬂaws we study in this paper results in the genera-
tion of RSA moduli that share a single common prime
factor. In that case, one might have two RSA moduli
N1 = pq1 and N2 = pq2 that share the prime factor p
but have diﬀerent second factors q1 and q2. The two
moduli will appear distinct, but an attacker who can
ﬁnd such a pair can easily factor both of them by com-
puting p = gcd(N1, N2) and dividing to discover q1 and
q2. These two operations can be performed in less than
one second on a standard modern laptop.

The authors of [26] and [21] discovered such ﬂaws
were widespread by collecting several million RSA pub-
lic keys from publicly available datasets, including HTTPS
certiﬁcate scans, PGP key servers, and SSH host scans,
and computing the pairwise common divisors of every
pair of RSA moduli in the datasets. (See Section 3.2.)
Since these original publications, the same technique
has been used to ﬁnd further vulnerable implementa-
tions: Bernstein et al. [6] found a random number gen-
eration ﬂaw in the Taiwanese national smart card infras-
tructure, and Albrecht, Papini, Paterson, and Villanueva-
Polanco [3] found a large number of weak keys among
export-grade RSA keys for TLS.

2.4 The random number generation ﬂaw
The implementation ﬂaws resulting in these weak keys
appear to have arisen independently in many diﬀerent
implementations, but [21] points to a common pattern:
on many headless, embedded, or low-resource devices,
the operating system random number generator may
not have incorporated any external sources of entropy
when it is used by an application to generate a crypto-
graphic key. If the key-generation process incorporates
additional low-entropy sources of randomness during
key generation—for example the current time or arriv-
ing network packets—applications running on diﬀerent
systems may have identical states during the generation
of the ﬁrst prime factor of the RSA modulus, and di-
verge during the generation of the second prime factor,
resulting in the exact situation described above.

The authors of [21] discovered a boot-time “entropy
hole” vulnerability in the Linux random number gener-
ator, where the output of /dev/urandom could be de-
terministic on boot in real usage, and noted that in this
situation OpenSSL’s key generation behavior could re-
sult in factorable keys. This combination was visible on
many but not all of the aﬀected product families.

The vulnerable factored keys were almost exclusively
conﬁned to network devices, rather than general pur-
pose web servers. Only a handful of the vulnerable
HTTPS certiﬁcates were signed by a browser-trusted
CA. While most of the vulnerable hosts were likely low-
value targets, their weak keys are an externally visible
sign of the underlying ﬂaw in the operating system, with
broader security implications for any service on the sys-
tem requiring randomness. This type of ﬂaw is diﬃcult
to detect in a standard unit test framework, making it
diﬃcult for vendors to discover and mitigate in normal
software development practices.
2.5 Responsible disclosure

The authors of [21] notiﬁed 61 vendors of the vul-
nerability between February and June 2012. Of these,
37 concerned vulnerable RSA keys, and the remainder
produced vulnerable DSA signatures only. Since our
main dataset consists only of RSA keys, we exclude the
DSA vulnerabilities from further analysis. Among the
RSA vulnerabilities, 28 vendor devices produced vulner-
able TLS certiﬁcates, and the rest produced vulnerable

517/2010 (EFF)

4/2016 (Censys)

TLS Handshakes
Distinct Certiﬁcates
Distinct RSA Keys

11,261,212
5,479,537
5,333,832

38,014,832
10,670,210
10,457,597

Table 3: Our dataset includes nearly six years of scans;
we summarize the earliest and latest above.

RSA SSH host keys. A complete list of aﬀected vendors
was never published. The authors ﬁrst attempted to
contact each vendor individually via email. They were
able to ﬁnd a security contact, either an email address
or web form, for 13 vendors by searching company web
sites, and in two cases via personal connections. For the
rest, they attempted to email security@domain.com
and support@domain.com. Later, CERT/CC and ICS-
CERT aided in contacting and coordination between
companies. Table 2 lists the vendors who were notiﬁed
about weak RSA keys and their responses.

In addition, the authors of [21] notiﬁed the main-
tainers for the Linux kernel, who published a patch in
July 2012 including several mitigations against the fail-
ures [36]. In July 2014, Linux introduced the getran-
dom() system call, which outputs nonblocking data only
after it has been properly seeded. This is the desirable
functionality for cryptographically secure random num-
ber generation. [37]

3. METHODOLOGY

In order to examine vulnerability rates over time,
we collected historical HTTPS scan data, extracted the
RSA public keys from server certiﬁcates, and performed
a massive batch GCD computation across all of the dis-
tinct RSA keys ever seen in our scans. We ﬁngerprinted
certiﬁcates to identify the server implementation.
3.1 Data sources

While weak keys have been found across many public-
key infrastructures, we chose to focus on HTTPS data,
as previous and ongoing measurement studies have pro-
vided a historical record to draw from.

The earliest internet-wide HTTPS scans we are aware
of are the EFF SSL Observatory [18], collected by Burns
and Eckersley in July 2010 and December 2010. These
two scans were performed over the course of two to three
months each, using Nmap [28] to scan for hosts with
port 443 open and a custom Python client to send a
client hello and collect a server’s certiﬁcate. We refer
to this dataset as “EFF”.

Heninger, Durumeric, Wustrow, and Halderman [21]
performed an internet-wide HTTPS scan over ﬁve days
in October 2011, ﬁrst using Nmap to scan hosts with
open TCP port 443, and using a custom Python client
to collect certiﬁcates over the course of several days.
We refer to this dataset as “P&Q”. Durumeric, Kasten,
Bailey, and Halderman began taking regular scans of

Figure 1: We aggregated HTTPS scan data from several
sources. The total number of hosts in each scan is shown
above, and the number of hosts serving keys we were
able to factor below.

the HTTPS ecosystem [16] in June 2012 and contin-
ued through January 2014; we refer to this dataset as
“Ecosystem”. These scans used the much faster Zmap
[17] port scanner and a custom certiﬁcate fetcher, and
the authors report that a single scan took 18 hours
on average to complete. The scans vary in frequency
from one to over 20 scans per month. Beginning in
October 2013, Rapid7’s Project Sonar [30] took weekly
scans over IPv4 space, also using the Zmap port scanner
with their own custom client implementation to collect
HTTPS certiﬁcates. We use their HTTPS data through
May 2015. Finally, Durumeric, Adrian, Mirian, Bailey,
and Halderman [13] have performed daily scans from
July 2015 through April 2016, made available through
the Censys search engine, using Zmap and an integrated
toolchain to collect TLS handshake data on port 443.
The Censys team also performs regular scans of IMAPS,
POP3S, and SMTPS using TLS and SSLv2; we ex-
tracted the RSA moduli for these datasets for use in our
batch GCD calculation, but did not include the certiﬁ-
cates or host records in the rest of our results. We also
included Censys SSH host key data.

In total, our dataset includes 1.5 billion host records,
representing an IP address and certiﬁcate pair on a
given date, and 131 million unique certiﬁcates. There
are 81.2 million RSA moduli, of which 313,330, or 0.37%
were factored using the methods described in the follow-
ing section. The data is hosted in a MySQL database on
a machine with a fast 6TB SSD cache layer and 28TB
of RAIDed HDDs for backup storage of the scan data.
Figure 1 illustrates the number of hosts seen over
time on port 443 and the number of hosts on port 443
whose public keys we were able to factor. Artifacts from
the diﬀerent scan methodologies used by each team are
clearly visible. Although most of these sources provided

0M10M20M30M40MTotalHosts07/201012/201010/201106/201202/201407/201505/20160K20K40K60K80KVulnerableCensysRapid7EcosystemP&QEFF52plications.) Then it uses a remainder tree to compute
zi = P mod N 2
for every Ni. Finally, for each Ni, it
i
outputs gcd(Ni, zi/Ni). If this value is not 1, then Ni
shares some common factor with at least one other mod-
ulus in the database.

Scaling this calculation to the 81 million moduli posed
some computational challenges. First, the code as writ-
ten was limited to running on a single shared-memory
system, and used threads to run arithmetic operations
in parallel at each level of the tree. Second, the imple-
mentation uses GMP [20] for bignum arithmetic oper-
ations, which are single threaded. This resulted in a
bottleneck at the central node in the middle of the tree,
the product of all 81 million RSA moduli.

To solve both of these problems, we made several
adaptations to the batch GCD algorithm that raise the
asymptotic complexity of the calculation but allow a
speedup in practice. The modiﬁed algorithm works

as follows. Instead of computing the product (cid:81) Ni of

N1...Nn moduli, we divide the moduli into k subsets
and compute the product {P1, . . . , Pk} for each subset.
We then compute a remainder tree for each product
with respect to each subset. Since we pair every prod-
uct with every subset, we are guaranteed to have cov-
erage of all possible pairs of moduli. This part of the
computation scales quadratically in the number of sub-
sets k. For each modulus Ni, this yields k expressions
{P1 mod N 2
i }. The algo-
rithm then completes the ﬁnal step as before, reporting
a modulus Ni as vulnerable if any of the subproducts
returned nontrivial common divisors.

i , . . . , Pk mod N 2

i , P2 mod N 2

This modiﬁcation allowed us to parallelize the compu-
tation across a cluster. We ran the computation across a
cluster of six machines with dual 18-core 2.30GHz Intel
Xeon E5-2699 v3 processors and 128GB of RAM each,
eight machines with dual 22-core 2.20GHz Intel Xeon
E5-2699 v4 processors and 512GB of RAM each, and
eight machines with dual 12-core 2.50GHz Intel Xeon
E5-2680 v3 processors and 512GB of RAM each. We
were additionally able to speed up the computation by
storing the entirety of the product and remainder trees
in RAM, where the original hardware used for the com-
putation had limited memory, requiring that the trees
be written to disk.

For the 81 million RSA keys in our database, we chose
k = 16. The entire computation took 86 minutes of
wall-clock time to ﬁnish on our cluster, representing
1089 CPU hours. The product and remainder trees re-
quired between 70 and 100 GB of storage on each node.
In contrast, running the original algorithm without
modiﬁcations entirely in memory on a machine with
quad 6-core 3.40GHz Intel Xeon E7-8893 processors with
3 TB RAM took 500 minutes and required over 500 GB
of memory to store the product and remainder trees.
3.3 Fingerprinting Implementations

Once we had identiﬁed the weak RSA keys in our
database, we linked them to the set of certiﬁcates con-

Figure 2: To parallelize the batch GCD computation
over a cluster, we divide the input into k subsets and
compute a product only over each subset. For each
subset, we compute the remainder tree with respect to
all subset products. The total amount of computation is
higher, but we achieve a speedup in practice by avoiding
the bottleneck of computing with respect to the very
large products in the center of the tree.

more frequent scans, we chose one representative scan
per month over the time period we examined.
In all
ﬁgures, each point represents a single scan.

We also found that the Rapid7 data included sets
of intermediate certiﬁcates without explicitly chaining
them, while the other scan data either excluded the is-
suer certiﬁcates or explicitly chained them. In order to
better correlate our results across datasets, we excluded
these intermediate certiﬁcates from our analysis by re-
constructing the chains using common names among all
certiﬁcates associated with each IP address and includ-
ing only the lowest certiﬁcate in the chain.
3.2 Batch GCD

In order to compute pairwise GCDs across all col-
lected moduli, we adapted the batch GCD implemen-
tation described in [21] 1. This code was originally re-
ported to perform the batch GCD computation on a
set of 11.1 million RSA moduli in 1.6 hours on a 16-
core Amazon cloud cluster compute instance with 60.5
GB of RAM. The batch GCD algorithm is fundamen-
tal to the feasibility of our study: it runs in quasilinear
time over the number of input moduli, while a naive
implementation that simply computes the GCD of all
pairs of moduli runs in quadratic time in the number of
moduli. The computation time required by the latter is
not feasible for the dataset sizes used in this paper.

input moduli P = (cid:81) Ni.

The algorithm, which is adapted from an algorithm
described by Bernstein [5], has two main phases. First,
it uses a product tree to compute the product of all
(A product tree computes
the product of its inputs using a binary tree of multi-

1Available publicly on https://factorable.net.

N1N2N3N4N3N4N4N3N1N2N2N1mod(N1N2)2mod(N1)2/N1gcd(·,N1)mod(N2)2/N2gcd(·,N2)mod(N3N4)2mod(N3)2/N3gcd(·,N3)mod(N4)2/N4gcd(·,N4)53Date scanned

HTTPS
04/11/2016

SSH
10/29/2015

POP3S
04/25/2016

IMAPS
04/25/2016

SMTPS
04/25/2016

Total hosts with public keys
Hosts with RSA keys
Vulnerable hosts

38,014,832
37,931,417
59,628

10,730,527
6,257,106
723

4,533,094
4,533,094
0

4,544,158
4,544,158
0

3,292,031
3,292,031
0

Table 4: We included datasets of RSA public keys on diﬀerent protocols into our batch GCD computation, but found
that the majority of vulnerable keys were associated with HTTPS. We excluded these other protocols from further
analysis. The scan data above is from the Censys project.

taining these moduli and attempted to identify the un-
derlying implementations using available information.

3.3.1 Certiﬁcate subject ﬁngerprints
For many implementations, the certiﬁcate subjects
clearly identiﬁed a device manufacturer and model. We
identiﬁed the majority of host records using certiﬁcate
subjects. We observed that for vulnerable implementa-
tions end users typically did not alter the default certiﬁ-
cate values provided by the device, so it was straight-
forward to map from distinguished name to vendor.

For example, the Hewlett-Packard, Xerox, TP-LINK,
and Conel s.r.o. devices generating weak keys in our
dataset all generate certiﬁcates containing “O=vendor ”
in the distinguished name. We also used the distin-
guished name to directly identify models. Cisco certiﬁ-
cates in particular used the organizational unit section
of the distinguished name to refer to the model of the
device. There were 5,274,287 certiﬁcates that identiﬁed
a vendor in this fashion.

In other cases, sets of certiﬁcates had consistent dis-
tinguished or common names, but did not name a ven-
dor. In some cases, the content being served via HTTPS
for a host of interest was a login or informational page
identifying the vendor and model of the device. For ex-
ample, McAfee’s SnapGear 300 certiﬁcate distinguished
name had ﬁelds“CN=Default Common Name, O=Default
Organization, OU=Default Unit. . . ”, etc. The content
served over HTTPS for these hosts was the home page
for a SnapGear Management Console. Similarly, ev-
ery Juniper certiﬁcate contained the ﬁeld “CN=system
generated”. We labeled 26,272,330 certiﬁcates from 18
vendors using this heuristic.

3.3.2 Fingerprinting prime behavior
We found that in the vast majority of cases, devices
sharing prime factors were identiﬁed as the same ven-
dor. We used this information to extrapolate vendors
for some certiﬁcates we could not otherwise identify.

We used a heuristic to identify shared prime factors.
For a vendor with clearly identiﬁable certiﬁcates, we
created a pool of all prime factors generated by the ven-
dor. We then examined our set of moduli and set aside
all moduli produced using a prime from the pool. Any
certiﬁcate containing one of these moduli, we labeled
as the original vendor. Excepting a few special circum-

stances which we discuss below, this heuristic uniquely
labeled certiﬁcates.

In a special case, a bug in the prime-generation code
of certain IBM Remote Server Administration cards and
BladeServer Management Modules led to only nine pos-
sible primes being generated. Every public key associ-
ated with these devices was the product of two of these
primes. [21]. Most of these certiﬁcates did not contain
information identifying IBM. We identiﬁed 3,229 certiﬁ-
cates using an IBM prime, and labeled them all IBM.

In examining the IBM data, we found an overlap
between a modulus in the vulnerable IBM clique and
devices identiﬁed as Siemens Building Automation, an
interface for building-wide operations such as alarms,
time schedules, and HVAC systems. The Siemens-identiﬁed
modulus began appearing in February 2013 and con-
tinued to appear in scans throughout the study. This
aﬀected 2,441 certiﬁcates. There were 18 vulnerable
certiﬁcates identiﬁed as Siemens that did not use an
IBM modulus. There were about 15,000 total Siemens
certiﬁcates, which we identiﬁed using certiﬁcate subject
information.

We used extrapolation via shared prime factors to la-
bel certiﬁcates associated with Fritz!Box DSL modems.
Many Fritz!Box certiﬁcates had a common name with
some subdomain of myfritz.net. Others ﬁlled in the
alternative name with identiﬁable domain names:
DNS:fritz.fonwlan.box, DNS:fritz.box,
DNS:www.fritz.box, DNS:myfritz.box,
DNS:www.myfritz.box. These were easy to identify.
However, there were tens of thousands of certiﬁcates
whose certiﬁcate subject identiﬁed only an IP address
in octets. We labeled these as Fritz!Box if they shared a
common prime factor with certiﬁcates ﬁngerprinted via
certiﬁcate data or Nmap host identiﬁcation. We were
able to label 20,717 certiﬁcates as Fritz!Box using these
heuristics.

We also found an overlap in shared primes between
Xerox and Dell certiﬁcates. On closer examination, we
found that a set of machines with a certiﬁcate subject
containing “OU=Dell Imaging Group” all shared primes
with Xerox devices. In 2004, Dell announced a partner-
ship with Fuji Xerox, which specializes in imaging tech-
nologies [23]. Later, reviews of Dell printers claim they
are manufactured by Xerox [11]. This overlap aﬀected
416 certiﬁcates.

543.3.3 Internet Rimon Man-in-the-Middle
In attempting to identify shared implementations via
shared cryptographic keys, we discovered that an Is-
raeli ISP, Internet Rimon, was substituting its own RSA
modulus into the self-signed certiﬁcates being served by
the internet-facing services on devices belonging to its
customers. Only the public key and the signature (as
well as the choice of hash function used in the signa-
ture) were changed; the rest of the certiﬁcate remained
unchanged. Internet Rimon oﬀers an opt-in content ﬁl-
tering service for its customers via installation of a root
certiﬁcate on the customer’s machine, but this is the
ﬁrst case we have seen of an ISP man-in-the-middling
inbound encrypted connections to its customers’ devices
by substituting their public keys for a ﬁxed key of its
own. We saw 922 distinct IP addresses with this key,
appearing in scans throughout the entire study period.
We did not factor the 1024-bit RSA modulus used by

Internet Rimon.

3.3.4 Fingerprinting OpenSSL primes
Mironov [29] observes that OpenSSL uses a distinc-
tive method of prime generation that eliminates primes
p such that p − 1 is divisible by any of the ﬁrst 2048
primes. He estimates that the probability that a ran-
domly chosen 512-bit prime satisﬁes this property is
about 7.5%. This property would also be satisﬁed if an
implementation only generated “safe” primes (a prime
p where (p − 1)/2 is also prime). We found that none
of our labeled vulnerable vendors produced exclusively
safe primes, although they do arise in the dataset by
chance. We did not ﬁnd any vulnerable implementa-
tions producing exclusively safe primes, suggesting that
the property is a true OpenSSL ﬁngerprint.

We can use this property to identify implementations
as likely OpenSSL and deﬁnitely not OpenSSL by exam-
ining the fraction of prime factors of weak keys that sat-
isfy this property. If an implementation uses OpenSSL
to generate primes, every prime factor pi for every mod-
ulus associated with this implementation should satisfy
pi (cid:54)= 1 mod qi for each of the 2048 primes checked by
OpenSSL. If an implementation is not OpenSSL, we
would expect that only a small fraction of the prime
factors associated with this implementation would sat-
isfy this property.

We found that 71,417 of the certiﬁcates with weak
keys were not OpenSSL, about 5% of all certiﬁcates with
broken moduli. Table 5 categorizes vendors according
to this OpenSSL ﬁngerprint. Because the ﬁngerprint
requires the private key, it only covers models gener-
ating vulnerable keys. For vendors like Juniper where
we cannot distinguish diﬀerent product models, we can
only state that there exists a non-OpenSSL implemen-
tation generating weak keys.

3.3.5 Bit errors
107 (0.03%) of the 313,330 vulnerable moduli in our

Satisfy OpenSSL ﬁngerprint

Do not satisfy

MitraStar

IBM
2Wire
Innominate
AdTran
Allegro
Linksys
BridgeWave McAfee
Cisco
Conel s.r.o. Netgear
D-Link
Dell
Fritz!Box
HP
TP-LINK

NTI
Sangfor
Schmid Telecom
ServerTech
SkyStream Networks
Thomson

DrayTek
Fortinet
Huawei
Juniper
Kronos
Siemens
Xerox
ZyXEL

Table 5: OpenSSL uses a distinctive prime generation
process that allows us to use the primes in a private
RSA key to distinguish vendors who are likely using
OpenSSL to generate keys from those that are not. We
classiﬁed device vendors from our TLS scan data.

database are not the product of two equal-sized primes,
that is, they are not well-formed RSA moduli. These
corresponded to 113 certiﬁcates in our database.
In
many cases, this appeared to be due to bit errors. For
example, we found 11 diﬀerent “certiﬁcate authority”
certiﬁcates in our database with non-well-formed RSA
keys that were at least one bit error from a nearly iden-
tical valid certiﬁcate.
(In the case of the certiﬁcates
with errors, the signatures of course will fail to verify.)
One or more bit ﬂips in a valid RSA modulus would
be expected to produce a random integer; this integer
would be divisible by some prime qi with probability
1/qi. Thus such bit errors are likely to show up in the re-
sults of our batch GCD computations with divisors that
are the product of many small prime factors. Anecdo-
tally, such errors have been observed to appear in other
large key corpuses such as the PGP keyservers. [7]

We set these cases aside and did not treat them as
indicators of a ﬂawed implementation, since they could
have resulted from memory errors on the host, errors
on the wire, or errors during storage or download of
the datasets. A small portion of these certiﬁcates were
presented multiple times by the same hosts across scans.
Most, however, were seen exactly once, indicating some
error with the transmission or storage of the key.
4. RESULTS

In this section, we examine the behavior of vendor
devices based on the company response to the vulnera-
bility disclosures by the authors of [21].
4.1 Vendors that released a public disclo-

sure

Five companies released public security advisories for

TLS vulnerabilities2.
2https://factorable.net/advisories.html

55Figure 3: The number of vulnerable Juniper hosts con-
tinued to rise for years after Juniper’s published security
advisories and public disclosure. The single largest drop
in the number of both vulnerable and total number of
ﬁngerprinted hosts occurred during April 2014, which
correlates with the disclosure of Heartbleed, marked
with a vertical line.

Juniper, whose products represented the majority of
factored keys in 2012 and the second highest number
over all scans, released a public Security Bulletin in
April 2012 and an Out-of-Cycle Security Notice in July
2012 announcing that the weak key vulnerability had
been internally discovered and ﬁxed. The exact de-
vice model is not apparent from the certiﬁcate data
or the HTTPS login page, but Juniper has identiﬁed
the vulnerable models as SRX branch security devices.
Juniper certiﬁcates do not identify device models, and
the default certiﬁcate matching our ﬁngerprint can be
generated by diﬀerent Juniper models. We generated a
certiﬁcate on a Juniper SSG5 security platform running
ScreenOS that has the same ﬁngerprint as the Juniper
certiﬁcates in our scan.

Our data shows that that the number of vulnera-
ble hosts continued to increase for two years follow-
ing disclosure, and end-user patching was minimal at
best. (Figure 3.) In order to better understand patch-
ing behavior, we examined the vulnerability status of
ﬁngerprinted Juniper hosts in more detail. Over the
entire course of our scan data, we observed 169,000 IP
addresses serving a ﬁngerprinted Juniper certiﬁcate, of
which 34,000 hosts served vulnerable keys. Of these,
1,100 hosts transitioned from a certiﬁcate containing a
vulnerable key to a certiﬁcate containing a non-vulnerable
key, 1,200 transitioned from a certiﬁcate containing a
non-vulnerable key to a certiﬁcate containing a vulner-
able key, and 250 transitioned between vulnerable and
non-vulnerable certiﬁcates multiple times.

There is an abrupt decrease in the number of ﬁnger-
printed Juniper hosts, both total and those generating
weak keys, between April 2014 and May 2014. Juniper
released four security advisories in April 2014 for vari-
ous vulnerabilities, including a patch for the OpenSSL

Figure 4: The number of broken Innominate mGuard
hosts increased from the original 2012 notiﬁcation and
has stayed mostly consistent during the four years since
the public security advisory.

“Heartbleed” issue on April 23, 2014 [1]. The security
advisory states that the SRX branch devices identiﬁed
as generating vulnerable keys were not vulnerable to
Heartbleed.

During the aftermath of Heartbleed, nearly 30,000
Juniper-ﬁngerprinted hosts went oﬄine entirely, includ-
ing over 9,000 vulnerable devices. This suggests that de-
vice owners disabled TLS on port 443, blocked external
scans, or took devices oﬄine in response to Heartbleed.
Anecdotal reports suggest that Juniper NetScreen ﬁre-
walls crashed when scanned for Heartbleed [39].

Innominate, now Phoenix Contact Cyber Security,
manufactures security appliances for industry settings.
In June 2012, they released a security advisory about
weak keys in mGuard network security devices. Since
the notiﬁcation and advisory, the number of vulnera-
ble mGuard hosts has remained roughly ﬁxed. Out of
561 IP addresses that ever served vulnerable Innomi-
nate certiﬁcates, two hosts served non-vulnerable In-
nominate certiﬁcates and transitioned to a vulnerable
public key in subsequent scans, three served vulnera-
ble certiﬁcates and transitioned to non-vulnerable cer-
tiﬁcates in subsequent scans, and one host transitioned
from non-vulnerable to vulnerable and back again. Over
the time period covered by our scan data, the total num-
ber of Innominate-ﬁngerprinted devices has risen (Fig-
ure 4), suggesting that the vulnerability has been ﬁxed
in newer devices, but the population of originally vul-
nerable devices continue to serve vulnerable certiﬁcates.
IBM BladeCenter Management Module and Remote
Supervisor Adapter II cards generated only 36 possible
public keys from 9 possible prime factors, as described
in Section 3.3. 99.5% of the certiﬁcates we were able to
identify as one of these IBM products contained these
moduli. IBM published a security advisory (CVE-2012-
2187) in September 2012. Nearly all certiﬁcates con-
tained non-ﬁngerprintable identifying information from
the organizations themselves, although we found 51 cer-

07-201012-201010-201106-201202-201407-201505-20160K20K40K60K80KHostsCensysRapid7EcosystemP&QEFFTotalVulnerableHeartbleed07-201012-201010-201106-201202-201407-201505-20160200400600HostsCensysRapid7EcosystemP&QEFFTotalVulnerable56Figure 5: We ﬁngerprinted IBM Remote Supervisor
Adapter II and BladeCenter Management Modules us-
ing the 36 possible public keys that could be generated
by these implementations. The vulnerable population
appears to have been decreasing already by 2012, and
shows a marked decrease at the time of the Heartbleed
vulnerability in April 2014.

tiﬁcates labeled as Remote Supervisor Adaptors. For
this reason, we do not have an estimate of the total
population for these devices. Figure 5 shows the num-
ber of vulnerable hosts over time; the vulnerable pop-
ulation appears to have already been decreasing at the
time of disclosure in 2012, and drops sharply in April
2014, corresponding to the Heartbleed disclsosure.

Examining certiﬁcate lifetimes and replacement on
each host suggests that the vulnerable population of
IBM devices was decreasing because devices (or their
publicly accessible web interfaces) were taken oﬄine al-
together, and not because users patched the vulnerabil-
ity and renewed their HTTPS certiﬁcates on the same
device with a non-vulnerable public key. Among the
1,728 IP addresses that ever served a certiﬁcate con-
taining one of the vulnerable IBM primes in any of
our scans, 350 served a certiﬁcate during any of the
scans that did not contain a vulnerable public key. The
varying subjects of these new certiﬁcates indicated that
these new certiﬁcates were due to IP churn.

Intel and Tropos released public vulnerability disclo-
sures in the aftermath of [21], but these vulnerabili-
ties concerned vulnerable SSH host keys on port 22, for
which we do not have comprehensive data. Moxa also
released a public disclosure for a vulnerability in DSA
signatures, which we do not address in this study.
4.2 Vendors that responded privately

Several companies responded substantively to the vul-
nerability notiﬁcation but did not release a public an-
nouncement.

Multiple lines of Cisco small business products gen-
erated weak keys. As mentioned in Section 3.3, most
Cisco certiﬁcates clearly identiﬁed full model names in
the certiﬁcate distinguished name, so we were able to la-
bel 81% of certiﬁcates (and 91.5% of broken certiﬁcates)
with a model. Although Cisco responded in private to
the vulnerability notice, they never released a public se-

Figure 6: The number of broken Cisco hosts (bottom)
increased steadily through 2014, although it has begun
to decrease in the past year.

curity advisory and do not appear to have patched the
vulnerability for several years, as the number of vulner-
able hosts continued to increase for the next three years.
(Figure 6.)

The detailed model information in Cisco certiﬁcates
allows us to study the eﬀect of end-of-life announce-
ments on device populations in the wild. Of the 14
vulnerable models we labeled, 10 have released an end-
of-life announcement with a ﬁnal sale date before May
6, 2016. We found that the end-of-life announcements
marked the beginning of a slow decrease in the total
number of devices online. We also note that the end-
of-life announcement typically preceded the end-of-sale
date by several months. (Figure 7.)

HP’s Integrated Lights Out out-of-band management
cards generated weak keys. The number of vulnerable
hosts appears to have peaked in 2012, and has been
decreasing steadily since, as shown in Figure 8. There is
a notable drop in the number of vulnerable hosts as well
as the total number of HP hosts in the months after the
Heartbleed disclosure in April 2014. HP iLO cards were
reported to crash when scanned for Heartbleed [39].

The population of other vendors’ devices in this cat-

egory was too small to draw conclusions from.
4.3 Vendors that never responded

Figure 9 illustrates the ﬁngerprinted populations and
number of vulnerable hosts for ten vendors who did
not respond to the vulnerability notiﬁcation. In most
cases, the population of vulnerable hosts is declining
gradually, outside of apparent diﬀerences due to diﬀer-
ent scanning methodology across our datasets. Four of
these vendors (Thomson, Linksys, ZyXEL, and McAfee)
show a decline in the vulnerable population that closely
tracks the decline in the overall number of hosts with
that device ﬁngerprint. Fritz!Box shows a marked in-
crease in the vulnerable population before an eventual
decline, suggesting that the vulnerability may have been
ﬁxed for new devices at some point in 2014.

07-201012-201010-201106-201202-201407-201505-20160200400600HostsCensysRapid7EcosystemP&QEFFHeartbleed0K100K200KTotalHosts07/201012/201010/201106/201202/201407/201505/20160K2K4K6K8K10KVulnerableCensysRapid7EcosystemP&QEFF57Figure 7: We found that Cisco’s end-of-life announce-
ments for their most popular small business routers gen-
erally mark the start of a gradual decline in the de-
vice population. We identiﬁed vulnerable hosts associ-
ated with all the device models in this ﬁgure except the
RV082.

4.4 Newly vulnerable products since 2012
Several companies had no or very few vulnerable de-
vices in 2012, but appear to have since released prod-
ucts with the random number generation vulnerability.
These newly vulnerable hosts are responsible for the ris-
ing number of vulnerable hosts visible over the past year
in Figure 1.

The ﬁrst vulnerable Huawei hosts appeared April 2015,
and the population has increased dramatically (Figure
10). An examination of their certiﬁcates did not reveal
a speciﬁc model. However, the certiﬁcates all identify
a business unit in India, while 84% of the total pop-
ulation of Huawei certiﬁcates matching our ﬁngerprint
identify India. We contacted Huawei via their vulnera-
bility reporting web page in May 2016. They responded
to our notiﬁcation and released a security advisory and
software update in August 2016.

D-Link was contacted about HTTPS RSA vulnera-
bility in 2012 and did not respond to the original noti-
ﬁcation. In 2012, the population of vulnerable devices
was small, but has since increased dramatically. We
contacted D-Link in May 2016 via their vulnerability
reporting web form and have not received a response.

ADTRAN was notiﬁed in 2012 about DSA vulnera-
bilities in SSH and responded at the time. The vulner-
ability for HTTPS RSA keys seems to have been newly
introduced in 2015. We contacted ADTRAN using the
customer support form in May 2016. They responded
substantively to our new notiﬁcation, but have not yet
released a public advisory or informed us of a software
update.

We attempted to contact Sangfor using the customer

support web form, but the request was closed.

The only contact we could ﬁnd for Schmid Telecom
was an Information Request web form; we did not re-

Figure 8: HP iLO out-of-band management cards re-
portedly crashed when scanned for the Heartbleed vul-
nerability. There is a noticeable decrease in the total
population of HP products in the months following the
Heartbleed disclosure.

ceive a response to our notiﬁcation. Schmid Telecom is
a multinational company, but all their vulnerable cer-
tiﬁcates identify an Indian subsidiary.
5. DISCUSSION

Our data, viewed as a collection of individual anec-
dotes on vendor responses to a security vulnerability,
illustrate the challenges faced by all parties in the vul-
nerability disclosure and mitigation process. From the
perspective of the reporting party, the disclosure re-
ceived no substantive response and no acknowledgement
of a deployed ﬁx for years for most vendors who were
contacted. While the decline of the vulnerable popula-
tion for many of these vendors suggests that their newer
product versions are no longer naively vulnerable, this
decline took years to become visible in the data. From
the vendor side, the recent introduction of several newly
vulnerable products illustrates how diﬃcult it can be to
keep old bugs out of new products.
5.1 Vendor notiﬁcation processes

There is considerable debate in the security research
community as well as among policymakers about the
ethics of public disclosure of security vulnerabilities.
The norm in the academic research community is gen-
erally “responsible disclosure” [2, 12] in which the re-
searcher notiﬁes the vendor before going public. How-
ever, the attempted notiﬁcation of several dozen ven-
dors studied in this paper shows how this process can
fail at multiple stages. Most of the vendors did not have
security contact information publicly available. We found,
between our disclosure process and in [21], 16 out of 42
vendors had a discoverable point of contact for reporting
vulnerabilities (see Sections 2.5 and 4.4 for details). The
majority of vendors who were contacted in [21] never re-
sponded to the notiﬁcation at all. The majority of those
vendors who did respond in some way never released a

RV082EndofLifeDateRV120WRV220WRV180/180WSA520/5400K50K100KTotalHosts07/201012/201010/201106/201202/201407/201505/20160102030VulnerableCensysRapid7EcosystemP&QEFFHeartbleed58Thomson

Fritz!Box

Linksys

Fortinet

ZyXEL

Kronos

Dell

Xerox

McAfee

TPLink

Figure 9: Many companies never responded to the vulnerability disclosure at all. In the above cases, the population
of vulnerable hosts seems to be declining over the past several years.

050,0001·1051.5·1052·105Total06-201010-201102-201307-201411-2015050100150200VulnerableCensysRapid7EcosystemP&QEFF02·1054·1056·105Total06-201010-201102-201307-201411-2015010,00020,000VulnerableCensysRapid7EcosystemP&QEFF050,0001·1051.5·105Total06-201010-201102-201307-201411-201505001,0001,500Vulnerable01·1052·105Total06-201010-201102-201307-201411-20150102030Vulnerable020,00040,000Total06-201010-201102-201307-201411-201502,0004,0006,0008,000Vulnerable020,00040,00060,00080,000Total06-201010-201102-201307-201411-2015050100150Vulnerable02,0004,0006,0008,000Total06-201010-201102-201307-201411-20150200400600Vulnerable02,0004,0006,0008,000Total06-201010-201102-201307-201411-20150200400600Vulnerable02,0004,0006,000Total06-201010-201102-201307-201411-20150200400Vulnerable02,0004,0006,000Total06-201010-201102-201307-201411-201502,0004,0006,000Vulnerable59ADTRAN

D-Link

public security advisory. These ﬁgures were repeated
on a smaller scale four years later in the more limited
security disclosure process we undertook for this paper.
Reporting vulnerabilities through an organization such
as CERT/CC is a potential alternative to directly con-
tacting vendors. Arora et al. [4] found that response
time from vendors decreases when reporting through
such an organization. However, Li et al. [27] found that
some CERT organizations did not follow up on the end-
point vulnerability disclosure information they shared,
and concluded that reporting vulnerabilities through
CERT organizations appeared to be of limited utility.

Despite the lack of organized vendor response, the
eventual declining vulnerability rates for most vendors
suggest that ultimately the underlying vulnerabilities
were ﬁxed for most new devices after several years. We
hypothesize that this is likely due to newer products
using updated versions of the Linux kernel that incor-
porate the software mitigations introduced by the main-
tainers in 2012. It remains an open problem to design
an experiment to test this hypothesis.

Huawei

Recommendations.

Sangfor

Schmid Telecom

Figure 10: Some vendors had few or no vulnerable hosts
in 2012, but appear to have released a vulnerable prod-
uct version since then.

Software and hardware vendors should provide a ded-
icated means of contact for security vulnerability noti-
ﬁcations, and when possible, an explicit statement of
procedures concerning security vulnerabilities. Such a
process should include a default timeline for public dis-
closure, acknowledgments, and a bug bounty policy for
certain classes of ﬂaws [19]. Alternatively, researchers
can take advantage of the well-deﬁned public disclosure
process and vendor coordination provided by organiza-
tions like CERT/CC. In addition to providing a dedi-
cated contact point, CERT/CC vulnerability disclosure
policy includes a default 45-day deadline for public dis-
closure. In the case of the process we studied, coordina-
tion via CERT resulted in at least two additional public
security advisories.

We leave it as an open problem to design mechanisms
to incentivize vendors to use the most up-to-date ver-
sions of operating systems and libraries in their prod-
ucts, in order to avoid old vulnerabilities reappearing in
new products, as we observed in Section 4.4.
5.2 Scoring and predicting vendor responses

Our data does not appear to show any correlation
between company size or customer population and re-
sponse to vulnerability notiﬁcation, nor between vendor
response and end-user vulnerability rates.

Future work might study in more detail the variables
leading to diﬀerent vendor responses, and design regu-
latory, economic, or commercial incentives to promote
more eﬀective security policies among vendors.
5.3 End-user patching behavior

In principle, our dataset should allow us to study end-
user patching behavior, but this requires software and
hardware vendors to make patches available. Only three

020,00040,00060,00080,000Total06-201010-201102-201307-201411-20150100200Vulnerable050,0001·1051.5·1052·105Total06-201010-201102-201307-201411-201505,00010,00015,00020,000Vulnerable020,00040,00060,000Total06-201010-201102-201307-201411-201501,0002,0003,000Vulnerable010,00020,00030,00040,000Total06-201010-201102-201307-201411-201501020Vulnerable05001,0001,500Total06-201010-201102-201307-201411-20150200400600800Vulnerable60vendors with HTTPS RSA vulnerabilities (Juniper, In-
nominate, and IBM) released a public security advisory
and patch for the vulnerability in 2012, so our visibility
into end-user patching behavior is limited.

Nevertheless, our data suggests that end user patch-
ing rates were low to nonexistent, and that decreases in
the vulnerable populations were due to devices or their
web interfaces being taken oﬄine altogether. This does
not seem to be due to devices being entirely unmain-
tained, as we see clear evidence of a drop in the vul-
nerable populations around the time of the Heartbleed
disclosure, suggesting that publicity campaigns around
vulnerabilities are both eﬀective at changing user be-
havior, as observed previously [15], and that such cam-
paigns can have unintended consequences. Since we do
not see such signiﬁcant events elsewhere in the dataset,
nor even a declining trend in the vulnerable populations
for Juniper or Innominate devices, it appears that most
users do not have a regular patching process in place,
and that widespread patching or mitigation for security
ﬂaws in these types of devices is a rare event.

We hypothesize that a major contributing factor to
the lack of observed patching is that this vulnerability
largely aﬀected web interfaces for devices rather than
web services. The low patch rates have distressing im-
plications for the security of the “internet of things”.
Yu et al. [41] survey a number of critical vulnerabilities
that remain unpatched across hundreds of thousands of
devices in the wild.

Previous work on end-user patching rates [40, 15] for
TLS vulnerabilities and vulnerability notiﬁcations [27,
34] have focused on system administrator behavior for
web sites. In contrast, the families of devices aﬀected
by the random number generation vulnerabilities in our
study fall into three broad classes:
industrial control
systems and critical infrastructure, router and ﬁrewall
products aimed largely at the small business market,
and cable and DSL modems and WiFi routers largely
aimed at individual consumers.

Recommendations.

Our results show that public disclosure and patching
of security vulnerabilities does not suﬃce to ensure end-
user security. Additional processes will be necessary
to ensure patches are deployed to consumers. The de-
sign of appropriate and eﬀective software update mech-
anisms and incentives will likely depend heavily on the
end users of the device.

For consumer-grade products, multiple studies have
shown that individual users are unable to eﬀectively
evaluate security concerns (e.g. [9, 33]), and will tend
not discover or apply patches. For these cases, actively
pushing updates to devices is likely the most eﬀective
security update policy. Such a policy has signiﬁcant
drawbacks, however: software updates may produce un-
intended side eﬀects or even brick devices [10]. There
is evidence that most users will eventually apply op-
tional patches that are pushed to devices they inter-

act with regularly: Thomas et al. [35] found that half
of all Android devices were updated within 30 days of
a patch becoming available via Android’s over-the-air
push mechanism, and 95% within a year. However,
many internet-of-things devices will likely lack a good
interface for users to manage such updates, so designing
a usable update mechanism remains an open problem.
In the case of devices aimed at small or medium busi-
ness consumers, we recommend that vendors encourage
customer IT staﬀ to adopt a “Patch Tuesday”-type pol-
icy for device updates as well as software products. This
requires vendors to remain on top of upstream software
updates for the software stacks used in their products,
and push or make available updated software versions
in a standardized manner to customers. The positive
responses by system administrators to active notiﬁca-
tion of software vulnerabilities [27, 34] and the eﬀects
of end-of-life policies on vulnerable device populations
discussed in Section 4.2 suggests that they may be re-
ceptive to active update notiﬁcations from vendors.

The process of applying software updates to indus-
trial control systems and critical infrastructure can be
complicated by operational, regulatory, and legal con-
siderations. It remains an open problem to design an
eﬀective software update mechanism that balances secu-
rity and reliability of critical systems in this framework.
5.4 Ethics and responsible disclosure

Detailed information on the random number gener-
ation vulnerabilities studied in this paper, the eﬃcient
batch GCD implementation, and the data sets used in
this paper have all been publicly available for years.

The majority of the vendors discussed in this paper
were directly notiﬁed of the vulnerability in 2012. In the
course of this research, we discovered ﬁve vendors who
appeared to have introduced newly vulnerable products
since 2012. We attempted to notify these vendors of the
new vulnerability in May 2016. Only two companies
have acknowledged receipt of our disclosure. Huawei
released a public security advisory and software update
in August 2016. The vulnerability was assigned CVE-
2016-6670. We give more details in Section 4.4.
6. ACKNOWLEDGEMENTS

We thank Joshua Pearlstein for his contributions to
the early stages of the project, and the anonymous re-
viewers for their extremely helpful and detailed feed-
back on our submission. This material is based upon
work supported by the National Science Foundation un-
der grants CNS-1513671, CNS-1408734, and a gift from
Cisco. We are grateful to Cisco for donating the UCS
servers we used for our computations.
7. REFERENCES
[1] Junos Pulse/IC (UAC): Details on ﬁxes for

OpenSSL “Heartbleed” issue
(CVE-2014-0160)/JSA10623.

61https://kb.juniper.net/InfoCenter/index?page=
content&id=KB29007&pmv=print&actp=LIST,
April 2014.

Communication Technology Research. Technical
report, U.S. Department of Homeland Security,
August 2012.

[2] Submitting papers: Human subjects and ethical

[13] Zakir Durumeric, David Adrian, Ariana Mirian,

considerations. https://www.usenix.org/
conference/usenixsecurity16/submitting-papers,
2016. Accessed: 2016-09-01.

[3] Martin R. Albrecht, Davide Papini, Kenneth G.

Paterson, and Ricardo Villanueva-Polanco.
Factoring 512-bit RSA moduli for fun (and a
proﬁt of $9,000).
https://martinralbrecht.ﬁles.wordpress.com/2015/
03/freak-scan1.pdf, 2015.

[4] Ashish Arora, Ramayya Krishnan, Rahul Telang,

and Yubao Yang. An empirical analysis of
software vendors’ patch release behavior: Impact
of vulnerability disclosure. Info. Sys. Research,
21(1):115–132, March 2010.

[5] D. J. Bernstein. How to ﬁnd smooth parts of

integers.
http://cr.yp.to/papers.html#smoothparts.

[6] Daniel J. Bernstein, Yun-An Chang, Chen-Mou

Cheng, Li-Ping Chou, Nadia Heninger, Tanja
Lange, and Nicko van Someren. Advances in
Cryptology - ASIACRYPT 2013: 19th
International Conference on the Theory and
Application of Cryptology and Information
Security, Bengaluru, India, December 1-5, 2013,
Proceedings, Part II, chapter Factoring RSA Keys
from Certiﬁed Smart Cards: Coppersmith in the
Wild, pages 341–360. Springer Berlin Heidelberg,
Berlin, Heidelberg, 2013.

[7] Hanno Bock. About the supposed factoring of a

4096 bit RSA key.
https://blog.hboeck.de/archives/872-About-the-
supposed-factoring-of-a-4096-bit-RSA-key.html.
[8] Kevin Butler, Toni R. Farley, Patrick McDaniel,
and Jennifer Rexford. A survey of BGP security
issues and solutions. In Proceedings of the IEEE,
volume 98, October 2013.

[9] Hong Chan and Sameera Mubarak. Article:

Signiﬁcance of information security awareness in
the higher education sector. International Journal
of Computer Applications, 60(10):23–31,
December 2012.

[10] Amit Chowdhry. Apple conﬁrms existence of the

‘Error 56’ iOS 9.3.2 bug.
http://www.forbes.com/sites/amitchowdhry/
2016/05/18/apple-ios-9-3-2-bug, 2016. Accessed:
2016-09-01.

[11] Edward J. Correia. Review: Dell C3765dnf

workgroup color printer.
http://www.crn.com/reviews/components-
peripherals/240154599/review-dell-c3765dnf-
workgroup-color-printer.htm, 2013.

[12] D. Dittrich and E. Kenneally. The Menlo Report:

Ethical Principles Guiding Information and

Michael Bailey, and J. Alex Halderman. A search
engine backed by Internet-wide scanning. In
Proceedings of the 22nd ACM Conference on
Computer and Communications Security, October
2015.

[14] Zakir Durumeric, David Adrian, Ariana Mirian,

James Kasten, Elie Bursztein, Nicolas Lidzborski,
Kurt Thomas, Vijay Eranti, Michael Bailey, and
J. Alex Halderman. Neither snow nor rain nor
MITM...: An empirical analysis of email delivery
security. In Proceedings of the 2015 ACM
Conference on Internet Measurement Conference,
IMC ’15, pages 27–39, New York, NY, USA, 2015.
ACM.

[15] Zakir Durumeric, James Kasten, David Adrian,

J. Alex Halderman, Michael Bailey, Frank Li,
Nicolas Weaver, Johanna Amann, Jethro
Beekman, Mathias Payer, and Vern Paxson. The
matter of Heartbleed. In Proceedings of the 2014
Conference on Internet Measurement Conference,
IMC ’14, pages 475–488, New York, NY, USA,
2014. ACM.

[16] Zakir Durumeric, James Kasten, Michael Bailey,
and J. Alex Halderman. Analysis of the HTTPS
certiﬁcate ecosystem. In Proceedings of the 13th
Internet Measurement Conference, October 2013.

[17] Zakir Durumeric, Eric Wustrow, and J. Alex

Halderman. ZMap: Fast Internet-wide scanning
and its security applications. In Proceedings of the
22nd USENIX Security Symposium, August 2013.
[18] Peter Eckersley and Jesse Burns. An observatory

for the SSLiverse.
https://www.eﬀ.org/ﬁles/DefconSSLiverse.pdf,
2010.

[19] Chris Evans, Eric Grosse, Neel Mehta, Matt

Moore, Tavis Ormandy, Julien Tinnes, Michal
Zalewski, and Google Security Team. Rebooting
responsible disclosure: a focus on protecting end
users. https://security.googleblog.com/2010/07/
rebooting-responsible-disclosure-focus.html, July
2010. Accessed: 2016-09-01.

[20] Torbj¨orn Granlund and the GMP development
team. GNU MP: The GNU Multiple Precision
Arithmetic Library, 5.0.5 edition, 2012.

[21] Nadia Heninger, Zakir Durumeric, Eric Wustrow,
and J. Alex Halderman. Mining your Ps and Qs:
Detection of widespread weak keys in network
devices. In Proceedings of the 21st USENIX
Security Symposium, August 2012.

[22] Ralph Holz, Johanna Amann, Olivier Mehani,

Matthias Wachs, and Mohamed Ali Kaafar. TLS
in the wild: an Internet-wide analysis of
TLS-based protocols for electronic

62communication. Proceedings of NDSS 2016,
February 2016.

[23] Cynthia B. Johnston and Darlene Caldarelli.

Xerox Corp.: Xerox International Partners and
Fuji Xerox align with Dell to expand imaging and
printing marketplace.
http://www.businesswire.com/news/home/
20040108005690/en/Xerox-Corp.-Xerox-
International-Partners-Fuji-Xerox, 2004.

[24] Thorsten Kleinjung, Kazumaro Aoki, Jens

Franke, Arjen K Lenstra, Emmanuel Thom´e,
Joppe W Bos, Pierrick Gaudry, Alexander
Kruppa, Peter L Montgomery, Dag Arne Osvik,
et al. Factorization of a 768-bit RSA modulus. In
Advances in Cryptology, CRYPTO ’10, pages
333–350. Springer, 2010.

[25] A. K. Lenstra and H. W. Lenstra, Jr., editors.

The Development of the Number Field Sieve.
Springer, 1993.

[26] Arjen K. Lenstra, James P. Hughes, Maxime

Augier, Joppe W. Bos, Thorsten Kleinjung, and
Christophe Wachter. Ron was wrong, Whit is
right. In 32nd International Cryptology
Conference, CRYPTO ’12, August 2012.
http://eprint.iacr.org/2012/064.

[27] Frank Li, Zakir Durumeric, Jakub Czyz,

Mohammad Karami, Michael Bailey, Damon
McCoy, Stefan Savage, and Vern Paxson. You’ve
got vulnerability: Exploring eﬀective vulnerability
notiﬁcations. In 25th USENIX Security
Symposium (USENIX Security 16), pages
1033–1050, Austin, TX, August 2016. USENIX
Association.

[28] Gordon Fyodor Lyon. Nmap network scanning:

The oﬃcial Nmap project guide to network
discovery and security scanning. Insecure, 2009.

[29] Ilya Mironov. Factoring RSA moduli. part ii.

https://windowsontheory.org/2012/05/17/
factoring-rsa-moduli-part-ii/, May 2012.
[30] Rapid7. Project Sonar SSL Certiﬁcates.

https://scans.io/study/sonar.ssl, April 2016.

[31] Ronald L Rivest, Adi Shamir, and Len Adleman.

A method for obtaining digital signatures and
public-key cryptosystems. Communications of the
ACM, 21(2):120–126, 1978.

[32] Hanna Smigala and Amanda Naiman. Siemens

and IBM team on next generation of cloud-based
building energy management solutions.
http://www-03.ibm.com/press/us/en/
pressrelease/49159.wss, February 2016.

[33] Jeﬀrey M. Stanton, Kathryn R. Stam, Paul

Mastrangelo, and Jeﬀrey Jolton. Analysis of end
user security behaviors. Comput. Secur.,
24(2):124–133, March 2005.

[34] Ben Stock, Giancarlo Pellegrino, Christian

Rossow, Martin Johns, and Michael Backes. Hey,
you have a problem: On the feasibility of
large-scale web vulnerability notiﬁcation. In 25th
USENIX Security Symposium (USENIX Security
16), pages 1015–1032, Austin, TX, August 2016.
USENIX Association.

[35] Daniel R. Thomas, Alastair R. Beresford, and
Andrew Rice. Security metrics for the Android
ecosystem. In Proceedings of the 5th Annual ACM
CCS Workshop on Security and Privacy in
Smartphones and Mobile Devices, SPSM ’15,
pages 87–98, New York, NY, USA, 2015. ACM.

[36] Theodore Ts’o. /dev/random ﬁxups.
https://lkml.org/lkml/2012/7/5/414.

[37] Theodore Ts’o. random: introduce getrandom(2)

system call. https://lwn.net/Articles/605828/,
2014.

[38] Luke Valenta, Shaanan Cohney, Alex Liao, Joshua

Fried, Satya Bodduluri, and Nadia Heninger.
Factoring as a service. In Financial Cryptography.
Springer, 2016.

[39] Rob VandenBrink. Be careful what you scan for!
https://isc.sans.edu/forums/diary/Be+Careful+
what+you+Scan+for/18017/.

[40] Scott Yilek, Eric Rescorla, Hovav Shacham,
Brandon Enright, and Stefan Savage. When
private keys are public: Results from the 2008
Debian OpenSSL vulnerability. In Anja Feldmann
and Laurent Mathy, editors, Proceedings of IMC
2009, pages 15–27. ACM Press, November 2009.

[41] Tianlong Yu, Vyas Sekar, Srinivasan Seshan,

Yuvraj Agarwal, and Chenren Xu. Handling a
trillion (unﬁxable) ﬂaws on a billion devices:
Rethinking network security for the
Internet-of-things. In Proceedings of the 14th
ACM Workshop on Hot Topics in Networks,
HotNets-XIV, pages 5:1–5:7, New York, NY,
USA, 2015. ACM.

63